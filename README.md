# Censored data regression benchmark materials

Contains all R code for performing the benchmark study, including:
- functional wrappers for performing the examined methods
- scripts for performing all components of the benchmark
- scripts for reproducing all figures and tabulating results
- scripts for performing our supplementary studies

# User guide

## Repository contents

### Functional wrappers for the examined methods
- `LASSOENET.R`: Least absolute shrinkage and selection operator (LASSO) and Elastic net (ENET)
- `ALASSO.R`: Adaptive LASSO (ALASSO)
- `CB.R`: CoxBoost (CB)
- `RSF.R`: Random survival forest (RSF) and Screened RSF (sRSF)
- `BHQV.R`: Benjami-Hoschberg (BH) and Q-value (QV) adjustment procedures
- `CARS.R`: Correlation-adjusted regression survival (CARS) scores with maximum Euclidean distance (MED) and minimal sextic residuals (MSR) thresholding techniques as described in our manuscript

### TCGA-BLCA cohort data and extraction code
- `TCGA_BLCA.R`: Produces `BLCA.RDS`
- `BLCA.RDS`: Our copy of the cohort data, generated by `TCGA_BLCA.R` on **April 28, 2025 at 12:48 PM CST**

### Preliminary feature selection on BLCA cohort
- `PFS.R`: Performs our preliminary feature selection (PFS) on the BLCA cohort data using CARS (top 3,000 features are retained), produces `CARS3000.RDS`
- `CARS3000.RDS`: Our copy of the results of PFS, generated by `PFS.R`

### Primary studies
- `RunSetting1.R`: Performs the first setting of simulations as described in our manuscript
- `RunSetting2.R`: Performs the second setting of simulations as described in our manuscript
- `RunRDA.R`: Performs the real data analysis as described in our manuscript

Note that these procedures are extremely computationally intensive due to a large number of study replications. The code is optimized for use in a cluster computing system where many cores (we used 248 for all studies) are available to permit parallelized replications. Even still, expect overall computation times of over 10 hours for setting 1, over 5 hours for setting 2, and over an hour for the real data analysis on high-end hardware. Reducing the number of replications reduces overall computation time almost proportionally.

### Produce main figures and tables
- `ProduceFigsAndTables.R`: Generates and saves figures and tables from the results of the primary studies

### TCGA cohort analysis
- `TCGA_BLCA_cohort_plots.R`: Recreates several plots involving the BLCA cohort, including:
  - Kaplan-Meier survival curves for males and females
  - Histograms of absolute pairwise correlations (APC) between features before and after PFS
  - Scatterplot of descending absolute CARS scores and the elbow point estimations (number of selected features) by MED and MSR

Note that computing and plotting APC is computationally and memory intensive.

### Supplementary contents
- `supplementary/elbow_stability.R`: Recreates the faceted boxplots of the elbow point estimations by MED and MSR in the first setting of our simulations
- `supplementary/pfs_or_not_comparison.R`: Performs two of the supplementary studies in our appendix:
  - Comparing the performance of embedded methods in terms of predictive performance and computation time, depending on whether PFS is used or not
  - Observing the relationship between feature signal-to-noise ratio and retention rate by PFS
- `supplementary/rsf_oob_vs_held_out.R`: Performs one of the supplementary studies in our appendix:
  - Comparing out-of-bag and held-out predictive metrics for evaluating RSF
- `supplementary/rsf_tuning_comp.R`: Performs one of the supplementary studies in our appendix:
  - Comparing three assignments of RSF hyperparameters, including R package defaults, cross-validation tuned hyperparameters (done at runtime), and the assignments we used in the benchmark (minimum nodesize of 8, and 403 candidate splitting features)

Note that these files can be computationally intensive to run.

## Quick start guide (performing the primary studies)

1. Install all required R packages with the correct versions. See the below section for the complete list.
2. Get `BLCA.RDS`. A timestamped copy can be found in our repository or downloaded and cleaned by running the file `TCGA_BLCA.R`.
3. Get `CARS3000.RDS`. A copy can be found in our repository or generated by running the file `PFS.R`.
4. If desired, modify the parameters of the studies within the corresponding file(s) (e.g. the data characteristics in setting-i, which methods are performed, the number of replications/folds, etc), or leave them as-is to recreate the studies as done in our manuscript. Ensure that the working directory is set correctly.
5. Run the contents of the file(s) from top to bottom. Be advised that these studies are very computationally intensive, and are optimized for cluster computing systems with many cores to run replications in parallel. All results will be stored in corresponding `.RDS` files.
6. All main figures and tables can be generated by running the contents of `ProduceFigsAndTables.R`.

## Required R packages (versions)

- `glmnet (1.0)`
- `Coxnet (0.2)`
- `CoxBoost (1.5)`
- `randomForestSRC (3.3.1)`
- `mutoss (0.1-13)`
- `WGCNA (1.72-5)`
- `carSurv (1.0.0)`
- `survival (3.7-0)`
